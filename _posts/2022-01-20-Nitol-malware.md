---
layout:     post
title:      恶意软件分析（五）：Nitol样本分析
subtitle:   僵尸网络进行DDos攻击样本分析
date:       2022-01-20
author:     Hongtai S
header-img: img/20.jpg
catalog: true
tags:
    - 逆向
    - 二进制
    - 恶意代码分析
---
# 样本基本信息

样本文件名称：lpk.dll

样本MD5：065906c6e4fed50dd61608cccd401b09

样本SHA-1：33578cc96311c2b02ac2ddc754863f6c2f927c91

样本SHA-256：097b61148b199f4fd0dfe4ee72757ef4158b5fb9bef5c91e8d1d1ab843f558f4

样本文件格式：C++编写的dll文件

![1.png](https://s2.loli.net/2022/03/02/4hGmYkgl5FE6fTp.png)

# 样本行为分析

## 创建名为Distribuwco互斥体

![2.png](https://s2.loli.net/2022/03/02/25JFQczAZhrNCWn.png)

## 释放资源节并执行文件

![3.png](https://s2.loli.net/2022/03/02/vOfGDmKAH7LbTe4.png)

## 将自身复制到系统路径

![4.png](https://s2.loli.net/2022/03/02/6BcNEDUbngazRxq.png)

名为******.exe其中*表示26个小写字母的随机字符

## 创建名为“Distribuwco”自启动服务

![5.png](https://s2.loli.net/2022/03/02/yLYojSFTrZMskRE.png)

## 修改注册表

![6.png](https://s2.loli.net/2022/03/02/UxrmakJhKts6oWq.png)

## 获取主机信息，包括操作系统版本、CPU信息等

![7.png](https://s2.loli.net/2022/03/02/KwOiqs5QU2YLboh.png)

# 样本功能分析

## 创建网络连接操作的僵尸线程

![8.png](https://s2.loli.net/2022/03/02/hcQBM5WiG3xyRIC.png)

## 以不同参数启动iexplorer.exe

![9.png](https://s2.loli.net/2022/03/02/I4d8znHWPRBZXq6.png)
![10.png](https://s2.loli.net/2022/03/02/q6j9d1TxBL8hkbr.png)
![11.png](https://s2.loli.net/2022/03/02/WLxYqJjfNKAtme5.png)

## 从指定的url下载并执行文件

![13.png](https://s2.loli.net/2022/03/02/x8IQXtuq91GdbEF.png)

## 为当前进程或桌面窗口创建进程iexplore.exe

![14.png](https://s2.loli.net/2022/03/02/8dmPDN3cUVvJkCe.png)
![15.png](https://s2.loli.net/2022/03/02/VtC7n5MslFhImRX.png)

## 与scrk.3322[.]org地址通信

![16.png](https://s2.loli.net/2022/03/02/ceGIp1mQdL7YoCO.png)

将该地址复制到安恒威胁情报中心平台，能够看到该地址是木马回连地址，与之通信的样本具有Nitol标签。

![17.png](https://s2.loli.net/2022/03/02/RumOdTsP1FyYJEj.png)

# 总结

木马运行后在主机留下后门并主动连接scrk.3322[.]org，由scrk.3322[.]org向被害主机发送远程控制命令，创建大量网络僵尸线程，进行各种DDos攻击。

目前，微软声称已经通过夺取对 3322.org 的控制权，屏蔽了攻击者对3322.org中恶意子域的控制。不过若通过伪装scrk.3322[.]org的远程控制命令，仍然可以控制失陷机进行DOS攻击。