---
layout:     post
title:      恶意软件分析（六）：“幼象”组织样本分析
subtitle:   python恶意样本分析
date:       2022-02-10
author:     Hongtai S
header-img: img/21.jpg
catalog: true
tags:
    - 逆向
    - 二进制
    - 恶意代码分析
---
# 样本1基本信息

样本MD5：6a271282fe97322d49e9692891332ad7

样本SHA1：0710e5b2432f18b181b404b87097fd8f61438f43

样本SHA256：97e6fa3d35adf36839e60a2a53e9701dca80e1eda0046310733277758c2bd3b8

样本文件类型：

![1.png](https://s2.loli.net/2022/03/04/uxoCndjpY7zOVLb.png)

样本是打包的python语言编写的

# 样本1分析

样本解包后得到可疑的python文件putty_strd.pyc

![2.png](https://s2.loli.net/2022/03/04/Wrdmun6cj2TxIA3.png)

反汇编改文件后查看其源码，其中连接了域名quwa-paf.servehttp[.]com的443号端口：

![3.png](https://s2.loli.net/2022/03/04/9rNfxe6ySJmTHDa.png)

连接后获取系统信息：

![4.png](https://s2.loli.net/2022/03/04/37GCieos8mxrHD9.png)

从恶意域名接收并执行命令：

![5.png](https://s2.loli.net/2022/03/04/aJM2kiDYdLuj1nw.png)

命令包括三种：

1. 结束进程 “exit”
2. 切换目录 “cd ” + 目录名
3. 执行shell命令 

# 样本2信息

样本MD5：7863e797c9f97ff4b7d1fad9cbae8b02

样本SHA1：8155986adecf5222ecda5a4be8485dcf5100b59b

样本SHA256：97e6fa3d35adf36839e60a2a53e9701dca80e1eda0046310733277758c2bd3b8

样本文件类型：

![6.png](https://s2.loli.net/2022/03/04/zM6eFZH4rpDCIB9.png)

样本是打包的python语言编写的

# 样本2分析

样本解包后得到可疑的python文件putty_strd.pyc

![7.png](https://s2.loli.net/2022/03/04/B8JMKuvTlhNVYeA.png)

反汇编改文件后查看其源码，其中连接了域名quwa-paf.servehttp[.]com的443号端口：

![8.png](https://s2.loli.net/2022/03/04/nCupOT2wjm7stH5.png)

从恶意域名接收并执行命令：

![9.png](https://s2.loli.net/2022/03/04/ydIsbeBaOpXiwJS.png)

命令包括：

1. 结束进程 “exit”
2. 切换目录 “cd ” + 目录
3. 获取系统信息 “getinfo”
4. 执行shell命令
